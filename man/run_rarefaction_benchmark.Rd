% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rarefaction_benchmark.R
\name{run_rarefaction_benchmark}
\alias{run_rarefaction_benchmark}
\title{Rarefaction benchmark (exploratory/consensus) with priority ordering & plateau}
\usage{
run_rarefaction_benchmark(
  consensus_file,
  output_dir,
  species_priority = c("hsapiens", "mmusculus", "rnorvegicus", "drerio", "dmelanogaster",
    "celegans", "ggallus", "xtropicalis"),
  use_modes = c("exploratory"),
  min_steps = 5L,
  window_k = 3L,
  min_abs_gain = 5L,
  min_rel_gain = 0.01,
  zero_streak_k = 3L
)
}
\arguments{
\item{consensus_file}{Path to consensus enrichment Excel/CSV for this run
(e.g., \code{.../consensus_enrichment_exploration_clean.xlsx}).}

\item{output_dir}{Directory where outputs are written.}

\item{species_priority}{Character vector of species labels to pin first
(e.g., \code{c("hsapiens","mmusculus","rnorvegicus","drerio","dmelanogaster","celegans","ggallus","xtropicalis")}).
Labels must match the column suffixes used in the consensus (e.g., \code{in_<label>_nobg}).}

\item{use_modes}{Character vector of modes to build. Any of \code{c("true_consensus","exploratory")}.
Default \code{"exploratory"}.}

\item{min_steps}{Minimum steps before testing plateau (default 5).}

\item{window_k}{Moving window (steps) for gain test (default 3).}

\item{min_abs_gain}{Absolute new-term gain over last \code{window_k} steps below which we stop (default 5).}

\item{min_rel_gain}{Relative gain over last \code{window_k} steps (sum/new total) below which we stop (default 0.01).}

\item{zero_streak_k}{Stop if the last \code{k} steps each added 0 terms (default 3).}
}
\value{
Invisibly returns a list with:
  \item{species_order}{final order used (named by mode)}
  \item{plateau}{per-ontology stop summaries (named by mode)}
  \item{paths}{written artifact paths}
}
\description{
Builds the same cumulative and permutation rarefaction curves as
\code{run_rarefaction_curves()}, but:
\itemize{
  \item pins a \strong{priority species list} first (e.g., core top models),
  \item adds remaining species via \strong{greedy contribution} (stepwise, ALL ontology),
  \item computes a \strong{statistical plateau} per panel (window gain + zero-streak; optional segmented + knee),
  \item writes \code{species_order_final_*.csv} and \code{plateau_detection_summary_*.csv},
        and draws a dashed vertical line at the suggested stop in each panel.
}
}
\details{
It \emph{does not} re-run g:Profiler; it consumes your already-computed consensus table
(and gracefully handles species with zero results by treating missing columns as 0/FALSE).
}
\keyword{internal}
